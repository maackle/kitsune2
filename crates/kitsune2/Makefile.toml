extend = "../../Makefile.toml"

# runs clippy with default features, which covers `transport-tx5-datachannel-vendored`
[tasks.clippy]
workspace = false
dependencies = ["clippy-transport-tx5-backend-go-pion", "clippy-transport-iroh"]

[tasks.clippy-transport-tx5-backend-go-pion]
workspace = false
command = "cargo"
args = [
  "clippy",
  "--all-targets",
  "--no-default-features",
  "--features",
  "transport-tx5-backend-go-pion",
  "--",
  "--deny=warnings",
]

[tasks.clippy-transport-iroh]
workspace = false
command = "cargo"
args = [
  "clippy",
  "--all-targets",
  "--no-default-features",
  "--features",
  "transport-iroh",
  "--",
  "--deny=warnings",
]

# runs test with default features, which covers `transport-tx5-datachannel-vendored`
[tasks.test]
workspace = false
dependencies = ["test-transport-tx5-backend-go-pion", "test-transport-iroh"]

[tasks.test-transport-tx5-backend-go-pion]
workspace = false
command = "cargo"
args = [
  "test",
  "--no-default-features",
  "--features",
  "transport-tx5-backend-go-pion",
  "--",
  "--nocapture",
]

[tasks.test-transport-iroh]
workspace = false
command = "cargo"
args = [
  "test",
  "--no-default-features",
  "--features",
  "transport-iroh",
  "--",
  "--nocapture",
]
